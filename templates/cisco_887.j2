service nagle
service tcp-keepalives-in
service tcp-keepalives-out
service timestamps debug datetime msec localtime show-timezone
service timestamps log datetime msec localtime show-timezone
service password-encryption
!
hostname {{ host.hostname }}
!
clock timezone {{ host.timezone }}
!
boot-start-marker
boot-end-marker
!
aqm-register-fnf
!
logging buffered 51200 warnings
!
no aaa new-model
!
ip dhcp excluded-address {{ host.dhcp1_start }} {{ host.dhcp1_end }}
ip dhcp excluded-address {{ host.dhcp2_start }} {{ host.dhcp2_end }}
!
ip dhcp pool lan
 network {{ host.lan_network }} {{host.lan_netmask }}
 default-router {{ host.lan_gateway }}
 dns-server {{ host.dns_servers }}
!
!
no ip domain lookup
ip domain name {{ host.domain_name }}
ip cef
login on-failure log
login on-success log
no ipv6 cef
!
!
username {{ host.username }} privilege 15 secret 5 {{ host.userpass }}
!
!
controller Cellular 0
 no lte modem link-recovery disable
 lte modem link-recovery rssi onset-threshold -110
 lte modem link-recovery monitor-timer 20
 lte modem link-recovery wait-timer 10
 lte modem link-recovery debounce-count 6
!
!
class-map match-any VOIP
 match protocol h323
 match protocol rtcp
 match protocol rtp
 match protocol sip
!
policy-map VOIPQoS
 class VOIP
  priority 2000
  set dscp ef
policy-map VOIP_QOS
 class class-default
  shape average 10000000
   service-policy VOIPQoS
!
class-map match-any REMOTE_DESKTOP_CL
 match access-group name RDP
!
policy-map RDP_QOS
 class REMOTE_DESKTOP_CL
  bandwidth percent 80
  fair-queue
policy-map YMCA_10M_QOS
 class class-default
  shape average 10000000
   service-policy RDP_QOS
!
!
!
crypto isakmp policy 10
 encr 3des
 authentication pre-share
 group 2
 lifetime 28800
crypto isakmp key YMCAl0ck0ut address 103.6.3.97
crypto isakmp keepalive 30 10 periodic
!
!
crypto ipsec transform-set ESP_3DES esp-3des esp-sha-hmac
 mode tunnel
!
!
!
crypto map VPN_HO 10 ipsec-isakmp
 set peer 103.6.3.97
 set transform-set ESP_3DES
 match address 100
!
!
!
!
interface Loopback0
 ip address {{ host.loopback_address }} 255.255.255.255
!
interface Tunnel{{ host.tunnel_id }}
 bandwidth 50000
 ip address {{host.tunnel_ip_client }} {{ host.tunnel_netmask }}
 ip mtu 1460
 ip flow ingress
 load-interval 30
 tunnel source Loopback0
 tunnel destination 172.16.150.49
 service-policy output YMCA_10M_QOS
 hold-queue 2000 out
!
interface ATM0
 no ip address
 shutdown
 no atm ilmi-keepalive
!
interface Cellular0
 no ipv6 address autoconfig
 ip address negotiated
 ip nat outside
 ip virtual-reassembly in max-reassemblies 64
 encapsulation slip
 dialer in-band
 dialer idle-timeout 0
 dialer string lte
 dialer watch-group 1
 dialer-group 1
 async mode interactive
 crypto map VPN_HO
!
interface Cellular1
 no ip address
 encapsulation slip
!
interface Ethernet0
 no ip address
 shutdown
!
interface FastEthernet0
 no ip address
!
interface FastEthernet1
 no ip address
!
interface FastEthernet2
 no ip address
!
interface FastEthernet3
 no ip address
!
interface Vlan1
 description LAN
 ip address {{ host.lan_gateway }} {{ host.lan_netmask }}
 ip nat inside
 ip virtual-reassembly in
 ip tcp adjust-mss 1400
!
!
ip forward-protocol nd
no ip http server
no ip http secure-server
!
!
ip nat inside source list NAT interface Cellular0 overload
!
ip route 0.0.0.0 0.0.0.0 {{host.tunnel_ip_dc }}
ip route 103.6.3.97 255.255.255.255 Cellular0
ip route 172.16.150.48 255.255.255.248 Cellular0
!
ip access-list extended NAT
 deny   ip host {{ host.loopback_address }} 172.16.150.48 0.0.0.7
 permit ip any any
ip access-list extended RDP
 permit tcp any any eq 3389
 permit tcp any eq 3389 any
!
ip sla 10
 icmp-echo 8.8.4.4 source-interface Vlan1
 frequency 10
ip sla schedule 10 life forever start-time now
ip sla 50
 icmp-echo 192.168.100.254 source-interface Tunnel{{ host.tunnel_id }}
 frequency 10
ip sla schedule 50 life forever start-time now
ip sla 100
 icmp-echo 8.8.8.8 source-interface Loopback0
 frequency 10
ip sla schedule 100 life forever start-time now
dialer-list 1 protocol ip permit
no dialer-list 1 protocol ipv6 permit
ipv6 ioam timestamp
!
snmp-server community computerone RO
snmp-server location {{ host.snmp_location }}
access-list 100 permit ip host {{ host.loopback_address }} 172.16.150.48 0.0.0.7
!
control-plane
!
!
!
mgcp behavior rsip-range tgcp-only
mgcp behavior comedia-role none
mgcp behavior comedia-check-media-src disable
mgcp behavior comedia-sdp-force disable
!
mgcp profile default
!
!
!
!
!
!
 vstack
banner exec ^C

^C
!
line con 0
 login local
 no modem enable
line aux 0
line 2
 no activation-character
 no exec
 transport preferred none
 transport input all
 stopbits 1
line 3
 exec-timeout 0 0
 script dialer lte
 modem InOut
 no exec
 rxspeed 100000000
 txspeed 50000000
line 8
 no exec
 rxspeed 100000000
 txspeed 50000000
line vty 0 4
 privilege level 15
 login local
 transport input telnet ssh
line vty 5 15
 privilege level 15
 login
 transport input none
!
scheduler allocate 20000 1000
!
end